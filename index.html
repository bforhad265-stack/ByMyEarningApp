<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Earner</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #d4af37; --bg: #fdfdfd; --text: #333; --white: #fff; --red: #e74c3c; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; }

        /* Auth */
        #auth-screen { position: fixed; height: 100vh; width: 100%; background: var(--white); z-index: 1000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .input-group { width: 85%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; outline: none; }
        .btn-main { background: var(--primary); color: white; border: none; padding: 12px; width: 90%; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

        /* Navbar & Sidebar */
        .navbar { background: var(--primary); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; color: white; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .sidebar { position: fixed; top: 0; right: -280px; width: 280px; height: 100%; background: var(--white); box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: 0.3s; z-index: 200; padding-top: 60px; }
        .sidebar.active { right: 0; }
        .menu-item { padding: 15px 20px; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 500; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 150; }
        .overlay.active { display: block; }

        /* Dashboard */
        .container { padding: 20px; padding-bottom: 80px; }
        .balance-card { background: var(--primary); color: white; padding: 25px; border-radius: 15px; text-align: center; margin-bottom: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .section { display: none; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        .social-box { background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #eee; }

        /* üî• Custom Unique Alert Box */
        #customAlert { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); background: white; padding: 25px; border-radius: 15px; width: 80%; max-width: 300px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 3000; transition: 0.3s; border-top: 5px solid var(--red); }
        #customAlert.active { transform: translate(-50%, -50%) scale(1); }
        .alert-icon { font-size: 50px; color: var(--red); margin-bottom: 15px; }
        .alert-msg { color: var(--red); font-weight: bold; font-size: 16px; margin-bottom: 20px; display: block; }
        .alert-btn { background: var(--red); color: white; border: none; padding: 8px 25px; border-radius: 20px; cursor: pointer; font-size: 14px; }

        /* Task Modal */
        .task-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 500; display: none; overflow-y: scroll; padding: 20px; box-sizing: border-box; }
        .timer-box { font-size: 24px; font-weight: bold; color: var(--red); text-align: center; margin: 20px 0; border: 2px dashed var(--red); padding: 15px; border-radius: 10px; background: #fff5f5; display: none; }
        .upload-area { border: 2px dashed var(--primary); padding: 20px; text-align: center; border-radius: 10px; margin-top: 15px; cursor: pointer; background: #fffdf5; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="overlay" id="alertOverlay"></div>
    <div id="customAlert">
        <i class="fas fa-exclamation-triangle alert-icon" id="alertIcon"></i>
        <span class="alert-msg" id="alertMsg">‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ!</span>
        <button class="alert-btn" onclick="closeAlert()">‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá</button>
    </div>

    <div id="auth-screen">
        <h2 style="color:var(--primary); font-size: 28px;">‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ</h2>
        <div id="login-form" style="width:100%; text-align:center;">
            <input type="email" id="lEmail" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤" class="input-group">
            <input type="password" id="lPass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°" class="input-group">
            <button class="btn-main" onclick="login()">‡¶≤‡¶ó‡¶á‡¶®</button>
            <p onclick="toggleAuth()" style="color:var(--primary); cursor:pointer;">‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®</p>
        </div>
        <div id="reg-form" style="display:none; width:100%; text-align:center;">
            <input type="text" id="rName" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ" class="input-group">
            <input type="email" id="rEmail" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤" class="input-group">
            <input type="password" id="rPass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°" class="input-group">
            <button class="btn-main" onclick="register()">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</button>
            <p onclick="toggleAuth()" style="color:var(--primary); cursor:pointer;">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        </div>
    </div>

    <div id="main-app" style="display:none;">
        <div class="navbar">
            <b style="font-size:18px;">My Wallet</b>
            <i class="fas fa-bars" style="font-size:22px; cursor:pointer;" onclick="toggleMenu()"></i>
        </div>

        <div class="sidebar" id="sidebar">
            <div class="menu-item" onclick="nav('home')"><i class="fas fa-home"></i> ‡¶π‡ßã‡¶Æ</div>
            <div class="menu-item" onclick="nav('job')"><i class="fas fa-tasks"></i> ‡¶Æ‡¶æ‡¶á ‡¶ú‡¶¨</div>
            <div class="menu-item" onclick="nav('social')"><i class="fas fa-share-alt"></i> ‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</div>
            <div class="menu-item" onclick="nav('withdraw')"><i class="fas fa-wallet"></i> ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞‡ßã</div>
            <div class="menu-item" onclick="nav('history')"><i class="fas fa-history"></i> ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø</div>
            <div class="menu-item" onclick="openSupport()"><i class="fab fa-whatsapp"></i> ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</div>
            <div class="menu-item" onclick="logout()" style="color:red;"><i class="fas fa-sign-out-alt"></i> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</div>
        </div>

        <div class="container">
            <div id="home" class="section active">
                <div class="balance-card">
                    <small>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</small>
                    <h1 id="mainBal">‡ß≥ 0.00</h1>
                    <small>User ID: <span id="uidText">...</span></small>
                </div>
                
                <h3>‡¶ï‡ßÅ‡¶á‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</h3>
                <div class="social-box" onclick="nav('job')">
                    <div><i class="fas fa-briefcase" style="color:orange;"></i> ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</div> <i class="fas fa-chevron-right"></i>
                </div>
                <div class="social-box" onclick="nav('social')">
                    <div><i class="fas fa-share-alt" style="color:blue;"></i> ‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</div> <i class="fas fa-chevron-right"></i>
                </div>
                <div class="social-box" onclick="openSupport()">
                    <div><i class="fab fa-whatsapp" style="color:green;"></i> ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</div> <i class="fas fa-chevron-right"></i>
                </div>
            </div>

            <div id="job" class="section">
                <h3 style="color:var(--primary);">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</h3>
                <div class="social-box" onclick="openTaskPage(1)">
                    <div><strong>Task 01</strong><br><small>‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü</small></div> <button class="btn-main" style="width:auto; margin:0; padding:5px 15px;">Start</button>
                </div>
                <div class="social-box" onclick="openTaskPage(2)">
                    <div><strong>Task 02</strong><br><small>‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü</small></div> <button class="btn-main" style="width:auto; margin:0; padding:5px 15px;">Start</button>
                </div>
            </div>

            <div id="social" class="section">
                <h3>‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</h3>
                <div class="social-box" onclick="doSocial('fb')"><i class="fab fa-facebook" style="color:#1877F2;"></i> ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</div>
                <div class="social-box" onclick="doSocial('tt')"><i class="fab fa-tiktok" style="color:black;"></i> ‡¶ü‡¶ø‡¶ï‡¶ü‡¶ï ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</div>
                <div class="social-box" onclick="doSocial('tg')"><i class="fab fa-telegram" style="color:#0088cc;"></i> ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</div>
            </div>

            <div id="taskModal" class="task-modal">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <h3>üìã ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</h3>
                    <i class="fas fa-times" style="font-size:24px; cursor:pointer;" onclick="closeTaskPage()"></i>
                </div>
                <div style="background:#fffbe6; padding:15px; border-radius:10px; margin-bottom:15px;">
                    <strong>‚ö†Ô∏è ‡¶®‡¶ø‡ßü‡¶Æ:</strong> <span id="taskRulesText">...</span>
                </div>

                <button id="startTaskBtn" class="btn-main" onclick="startTimerTask()">üöÄ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <div id="timerDisplay" class="timer-box">‡¶∏‡¶Æ‡ßü: <span id="timeLeft">05:00</span></div>

                <div id="proofSection" style="display:none; margin-top:20px;">
                    <h4 style="color:green; text-align:center;">‡¶∏‡¶Æ‡ßü ‡¶∂‡ßá‡¶∑! ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶¶‡¶ø‡¶®</h4>
                    <input type="text" id="taskAccount" placeholder="‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶æ‡¶Æ/‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞" class="input-group">
                    <input type="file" id="imgInput" hidden onchange="uploadImg()">
                    <div class="upload-area" onclick="document.getElementById('imgInput').click()">
                        <i class="fas fa-cloud-upload-alt" style="font-size:30px;"></i><br><span id="uploadStatus">‡¶´‡¶ü‡ßã ‡¶¶‡¶ø‡¶®</span>
                    </div>
                    <input type="hidden" id="finalImgLink">
                    <button class="btn-main" style="background:#333;" onclick="submitTaskProof()">‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</button>
                </div>
            </div>

            <div id="withdraw" class="section">
                <h3>‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</h3>
                <div style="background:white; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.05);">
                    <select id="wMethod" class="input-group"><option>Bkash</option><option>Nagad</option></select>
                    <input type="number" id="wAmount" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£" class="input-group">
                    <input type="text" id="wNumber" placeholder="‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞" class="input-group">
                    <button class="btn-main" onclick="reqWithdraw()">‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
                </div>
            </div>
            
            <div id="history" class="section"><h3>‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø</h3><div id="histList">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div></div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyAKl90n3tBz4U689Vx4r7DDNHxCii66GRk",
          authDomain: "money-earning-8b7f2.firebaseapp.com",
          projectId: "money-earning-8b7f2",
          storageBucket: "money-earning-8b7f2.firebasestorage.app",
          messagingSenderId: "954842327634",
          appId: "1:954842327634:web:bedc11b47ea736733bcd8b",
          measurementId: "G-TME0VM42Y3"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const imgbbKey = "6d207e02198a847aa98d0a2a901485a5";

        let userData = {}, settings = {}, currentTaskUrl = "", currentTaskId = "";
        let timerInterval;

        auth.onAuthStateChanged(u => {
            if(u) { document.getElementById('auth-screen').style.display='none'; document.getElementById('main-app').style.display='block'; loadData(u.uid); }
            else { document.getElementById('auth-screen').style.display='flex'; document.getElementById('main-app').style.display='none'; }
        });

        function loadData(uid) {
            document.getElementById('uidText').innerText = uid.slice(0,6);
            db.collection("users").doc(uid).onSnapshot(d => { userData = d.data(); document.getElementById('mainBal').innerText = '‡ß≥ ' + (userData.balance||0); });
            db.collection("settings").doc("appConfig").onSnapshot(d => { 
                settings = d.data(); 
                if(settings.themeColor) document.documentElement.style.setProperty('--primary', settings.themeColor);
            });
            db.collection("withdrawals").where("uid", "==", uid).orderBy("time", "desc").onSnapshot(s => {
                let h = ""; s.forEach(d => { let data = d.data(); let clr = data.status==='approved'?'green':'orange'; h += `<div style="background:white; padding:10px; margin-bottom:5px; border-left:4px solid ${clr}"><b>${data.method}</b> - ‡ß≥${data.amount} (${data.status})</div>`; });
                document.getElementById('histList').innerHTML = h;
            });
        }

        // üî• Custom Alert Function
        function showAlert(msg) {
            document.getElementById('alertMsg').innerText = msg;
            document.getElementById('customAlert').classList.add('active');
            document.getElementById('alertOverlay').classList.add('active');
        }
        function closeAlert() {
            document.getElementById('customAlert').classList.remove('active');
            document.getElementById('alertOverlay').classList.remove('active');
        }

        // Timer Task Logic
        function startTimerTask() {
            if(!currentTaskUrl) return showAlert("‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡¶æ‡¶ú ‡¶®‡ßá‡¶á!");
            window.open(currentTaskUrl, '_blank');
            
            document.getElementById('startTaskBtn').style.display = 'none';
            document.getElementById('timerDisplay').style.display = 'block';
            let timeLeft = 300; 
            
            timerInterval = setInterval(() => {
                let m = Math.floor(timeLeft / 60);
                let s = timeLeft % 60;
                s = s < 10 ? '0' + s : s;
                document.getElementById('timeLeft').innerText = `${m}:${s}`;
                timeLeft--;
                if (timeLeft < 0) {
                    clearInterval(timerInterval);
                    document.getElementById('timerDisplay').style.display = 'none';
                    document.getElementById('proofSection').style.display = 'block';
                    showAlert("‡¶∏‡¶Æ‡ßü ‡¶∂‡ßá‡¶∑! ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®‡•§");
                }
            }, 1000);
        }

        function openTaskPage(id) {
            clearInterval(timerInterval);
            resetModal();
            currentTaskId = "regular_" + id;
            currentTaskUrl = settings[`link${id}`];
            document.getElementById('taskRulesText').innerText = settings.taskRules || "‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";
            document.getElementById('taskModal').style.display = 'block';
        }

        function doSocial(type) {
            clearInterval(timerInterval);
            resetModal();
            currentTaskId = "social_" + type;
            if(type=='fb') currentTaskUrl = settings.fbLink;
            if(type=='tt') currentTaskUrl = settings.ttLink;
            if(type=='tg') currentTaskUrl = settings.tgLink;
            document.getElementById('taskRulesText').innerText = "‡¶≤‡¶æ‡¶á‡¶ï/‡¶´‡¶≤‡ßã ‡¶ï‡¶∞‡ßá ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶¶‡¶ø‡¶®‡•§";
            document.getElementById('taskModal').style.display = 'block';
        }

        function resetModal() {
            document.getElementById('startTaskBtn').style.display = 'block';
            document.getElementById('timerDisplay').style.display = 'none';
            document.getElementById('proofSection').style.display = 'none';
            document.getElementById('timeLeft').innerText = "05:00";
        }
        function closeTaskPage() { clearInterval(timerInterval); document.getElementById('taskModal').style.display = 'none'; }

        function uploadImg() {
            const f = document.getElementById('imgInput').files[0];
            const fd = new FormData(); fd.append("image", f);
            document.getElementById('uploadStatus').innerText = "‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
            fetch(`https://api.imgbb.com/1/upload?key=${imgbbKey}`, {method:"POST", body:fd}).then(r=>r.json()).then(d=>{ if(d.success) { document.getElementById('finalImgLink').value = d.data.url; document.getElementById('uploadStatus').innerText = "‚úÖ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!"; }});
        }

        function submitTaskProof() {
            const acc = document.getElementById('taskAccount').value;
            const img = document.getElementById('finalImgLink').value;
            if(!acc || !img) return showAlert("‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!");
            db.collection("taskProofs").add({ uid: auth.currentUser.uid, userName: userData.name, taskId: currentTaskId, accountUsed: acc, proofLink: img, status: "pending", time: firebase.firestore.FieldValue.serverTimestamp() }).then(() => { showAlert("‡¶ú‡¶Æ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); closeTaskPage(); });
        }

        // ‚úÖ Fixed Withdrawal Logic
        function reqWithdraw() {
            const am = parseInt(document.getElementById('wAmount').value);
            const num = document.getElementById('wNumber').value;
            
            if(!am || !num) return showAlert("‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶è‡¶¨‡¶Ç ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®!");
            // ‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶Æ‡ßã‡¶°: ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶ö‡ßá‡¶ï ‡¶∞‡¶ø‡¶Æ‡ßÅ‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶õ‡ßá‡•§ ‡¶ö‡¶æ‡¶á‡¶≤‡ßá if(am > userData.balance) return showAlert("‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á!"); ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®
            
            const b = db.batch();
            b.update(db.collection("users").doc(auth.currentUser.uid), { balance: firebase.firestore.FieldValue.increment(-am) });
            b.set(db.collection("withdrawals").doc(), { uid: auth.currentUser.uid, name: userData.name, amount: am, number: num, method: document.getElementById('wMethod').value, status: 'pending', time: firebase.firestore.FieldValue.serverTimestamp() });
            b.commit().then(()=>showAlert("‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶´‡¶≤!"));
        }

        function nav(id) { document.querySelectorAll('.section').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); toggleMenu(); }
        function toggleMenu() { document.getElementById('sidebar').classList.toggle('active'); document.getElementById('alertOverlay').classList.toggle('active'); }
        function openSupport() { if(settings.whatsapp) window.location.href=`https://wa.me/${settings.whatsapp}`; }
        function login() { auth.signInWithEmailAndPassword(document.getElementById('lEmail').value, document.getElementById('lPass').value).catch(e=>showAlert(e.message)); }
        function register() { auth.createUserWithEmailAndPassword(document.getElementById('rEmail').value, document.getElementById('rPass').value).then(c=>{ db.collection("users").doc(c.user.uid).set({name:document.getElementById('rName').value, email:document.getElementById('rEmail').value, balance:0}); }).catch(e=>showAlert(e.message)); }
        function logout() { auth.signOut(); }
        function toggleAuth() { document.getElementById('login-form').style.display = document.getElementById('login-form').style.display==='none'?'block':'none'; document.getElementById('reg-form').style.display = document.getElementById('reg-form').style.display==='none'?'block':'none'; }
    </script>
</body>
</html>
